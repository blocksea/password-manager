{"mappings":";;;;;;;;;4CAGM;;yCACA;AACN,4BAA4B;AAC5B,yCAAyC;AAEzC,qBAAqB;AACrB,MAAM,4BAAM;AAEZ,qCAAqC;AACrC,0BAAI,IAAI;AAER,gCAAgC;AAChC,0BAAI,IAAI,eAAQ;AAEhB,wBAAwB;AACxB,iDAAiD;AACjD,MAAM,6BAAO;AACb,MAAM,+BAAS;AACf,MAAM,uCAAiB;AAEvB,6BAA6B;AAC7B,MAAM,8BAAQ;AAGd,IAAI;AAEJ,uBAAuB;AACvB,qBAAqB;AACrB,uCAAuC;AACvC,0BAAI,MAAM,cAAc,IAAI,OAAO,KAAK;IACpC,IAAI,YAAY,EAAE;IAElB,YAAY,MAAM,mCACO,WAAW,sCACX,OACA;IAEzB,IAAI,KAAK;AACb;AAEA,iBAAiB;AACjB,0BAAI,MAAM,sBAAsB,IAAI,OAAO,KAAK;IAC5C,MAAM,KAAK,IAAI,OAAO;IACtB,MAAM,SAAS,MAAM,mCAAa,WAAW,sCACR,QAAQ;QAAC,KAAK,uCAAa;IAAG;IAEnE,IAAI,CAAC,QAAQ;QACX,IAAI,OAAO,KAAK,KAAK;YAAC,OAAO;QAAgB;QAC7C;IACF;IAEA,IAAI,KAAK;AACb;AAEA,wBAAwB;AACxB,0BAAI,MAAM,mBAAmB,KAAK,OAAO,KAAK;IAC1C,MAAM,MAAM,IAAI;IAChB,MAAM,SAAS,MAAM,mCAAa,WAAW,sCACR,UAAU;IAC/C,IAAI,OAAO,KAAK,KAAK;QAAE,KAAK,OAAO;IAAW;AAChD;AAEF,oBAAoB;AACpB,0BAAI,MAAM,uBAAuB,IAAI,OAAO,KAAK;IAC7C,MAAM,KAAK,IAAI,OAAO;IACtB,MAAM,MAAM,IAAI;IAEhB,gDAAgD;IAChD,IAAI,MAAM,uCAAa;IAEvB,MAAM,SAAS,MAAM,mCAAa,WAAW,sCACR,UAAU;QAAE,KAAK,uCAAa;IAAI,GAAG;QAAE,MAAM;IAAI;IAEtF,IAAI,OAAO,gBAAgB,GAAG;QAC5B,IAAI,OAAO,KAAK,KAAK,CAAC;QACtB;IACF;IAEA,IAAI,KAAK,CAAC;AACZ;AAEA,kBAAkB;AACpB,0BAAI,MAAM,kBAAkB,OAAO,OAAO,KAAK;IAC3C,MAAM,KAAK,IAAI,OAAO;IAEtB,uCAAuC;IACvC,MAAM,mCAAa,WAAW,sCACT,UAAU;QAAE,KAAK,uCAAa;IAAI;IAEvD,IAAI,KAAK,CAAC;AACZ;AAGF,uCAAuC;AACvC,0BAAI,OAAO,4BAAM;IACb,QAAQ,IAAI,kBAAkB,6BAAO;AACvC;AAEF,sBAAsB;AACtB,sCAAY,QAAQ,6BACjB,KAAK,CAAA;IACJ,qCAAe,OAAO,GAAG;AAC3B,GACC,MAAM,CAAA;IACL,QAAQ,IAAI;AACd","sources":["src/server.js"],"sourcesContent":["const express = require(\"express\");\nconst proxy = require(\"express-http-proxy\");\nconst cors = require(\"cors\");\nconst MongoClient = require(\"mongodb\").MongoClient;\nconst ObjectId = require(\"mongodb\").ObjectId;\n// import Password interface\n// import { Password } from \"./password\";\n\n// Create Express app\nconst app = express();\n\n// Add CORS to all routes and methods\napp.use(cors());\n\n// Enable parsing of JSON bodies\napp.use(express.json());\n\n// Initialize parameters\n// const port = eval(\"process.env.PORT\") || 3600;\nconst port = 3600;\nconst dbName = \"mean-passwordManager\";\nconst collectionName = \"passwords\";\n\n// database connection string\nconst dbUrl = 'mongodb+srv://admin:xOuG5xzD7E4ZZCdF@mycluster.upxjjyn.mongodb.net/?retryWrites=true&w=majority'\n\n\nlet dbConnection;\n\n// Define server routes\n// List all passwords\n// TODO: Task - Write whole GET Request\napp.route(\"/passwords\").get(async (req, res) => {\n    let passwords = [];\n  \n    passwords = await dbConnection\n                            .collection(collectionName)\n                            .find()\n                            .toArray();\n\n    res.json(passwords);\n});\n\n// Get a password\napp.route(\"/password-edit/:id\").get(async (req, res) => {\n    const id = req.params.id;\n    const result = await dbConnection.collection(collectionName)\n                                        .findOne({_id: new ObjectId(id)});\n  \n    if (!result) {\n      res.status(404).json({error: \"Could not find\"});\n      return;\n    }\n  \n    res.json(result);\n});\n\n// Create a new password\napp.route(\"/passwords-edit\").post(async (req, res) => {\n    const doc = req.body;\n    const result = await dbConnection.collection(collectionName)\n                                        .insertOne(doc);\n    res.status(201).json({ _id: result.insertedId });\n  });\n\n// Update a password\napp.route(\"/passwords-edit/:id\").put(async (req, res) => {\n    const id = req.params.id;\n    const doc = req.body;\n\n    // make sure the id field is correct object type\n    doc._id = new ObjectId(id);\n\n    const result = await dbConnection.collection(collectionName)\n                                        .updateOne({ _id: new ObjectId(id) }, { $set: doc });\n  \n    if (result.matchedCount == 0) {\n      res.status(404).json({});\n      return;\n    }\n  \n    res.json({});\n  });\n\n  // Delete a person\napp.route(\"/passwords/:id\").delete(async (req, res) => {\n    const id = req.params.id;\n  \n    // TODO: Task - Write delete query only\n    await dbConnection.collection(collectionName)\n                        .deleteOne({ _id: new ObjectId(id) });\n  \n    res.json({});\n  });\n\n  \n// Start server and listen for requests\napp.listen(port, function () {\n    console.log(\"Listening on \" + port + \".\");\n  });\n\n// database connection\nMongoClient.connect(dbUrl)\n  .then(client => {\n    dbConnection = client.db(dbName)\n  })\n  .catch(err => {\n    console.log(err)\n  })"],"names":[],"version":3,"file":"index.js.map"}